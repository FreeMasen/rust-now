<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Why Now - Now is the Time</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li><a href="chapter_1.html"><strong aria-hidden="true">1.</strong> Rust?</a></li><li><a href="chapter_2.0.html"><strong aria-hidden="true">2.</strong> How?</a></li><li><ol class="section"><li><a href="chapter_2.1.html"><strong aria-hidden="true">2.1.</strong> Mutability?</a></li><li><a href="chapter_2.2.html"><strong aria-hidden="true">2.2.</strong> Ownership and Borrowing</a></li><li><a href="chapter_2.3.html"><strong aria-hidden="true">2.3.</strong> Lifetimes?</a></li><li><a href="chapter_2.4.html"><strong aria-hidden="true">2.4.</strong> No Null?</a></li><li><a href="chapter_2.5.html"><strong aria-hidden="true">2.5.</strong> So?</a></li></ol></li><li><a href="chapter_3.0.html" class="active"><strong aria-hidden="true">3.</strong> Why Now</a></li><li><a href="chapter_4.0.html"><strong aria-hidden="true">4.</strong> Other Niceties</a></li><li><ol class="section"><li><a href="chapter_4.1.html"><strong aria-hidden="true">4.1.</strong> Arithmetic Data Types</a></li><li><a href="chapter_4.2.html"><strong aria-hidden="true">4.2.</strong> Pattern Matching</a></li><li><a href="chapter_4.3.html"><strong aria-hidden="true">4.3.</strong> Error Handling</a></li><li><a href="chapter_4.4.html"><strong aria-hidden="true">4.4.</strong> User Defined Types</a></li><li><a href="chapter_4.5.html"><strong aria-hidden="true">4.5.</strong> Traits</a></li><li><a href="chapter_4.6.html"><strong aria-hidden="true">4.6.</strong> Macros</a></li><li><a href="chapter_4.7.html"><strong aria-hidden="true">4.7.</strong> Tests</a></li></ol></li><li><a href="chapter_5.0.html"><strong aria-hidden="true">5.</strong> Getting Started</a></li><li><ol class="section"><li><a href="chapter_5.1.html"><strong aria-hidden="true">5.1.</strong> Rustup</a></li><li><a href="chapter_5.2.html"><strong aria-hidden="true">5.2.</strong> Cargo</a></li><li><a href="chapter_5.3.html"><strong aria-hidden="true">5.3.</strong> Bin vs Lib</a></li><li><a href="chapter_5.4.html"><strong aria-hidden="true">5.4.</strong> Std Types</a></li><li><a href="chapter_5.5.html"><strong aria-hidden="true">5.5.</strong> Resources</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Now is the Time</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>.presentation-only.not-presenting{display:none}.article-content.presenting{display:none}
</style>
<h1><a class="header" href="#why-now" id="why-now">Why Now?</a></h1>
<!--web-only-->
<p>If you have tried to learn rust in the past, you may have run into some friction around a few points. First is the old borrow checker, up until late last year the rust compiler could only use lexical scope to determine the life of any borrowed data, that meant we would have to jump through some hoops like this.</p>
<!--web-only-end-->
<!--slides-only-->
<h3><a class="header" href="#non-lexical-lifetimes" id="non-lexical-lifetimes">Non-lexical lifetimes</a></h3>
<!--slides-only-end-->
<pre><pre class="playpen"><code class="language-rust">fn main() {
    let mut x = 1;
    let y = &amp;mut x;
    {
       *y += 1;
    }
    println!(&quot;{}&quot;, x);
}
</code></pre></pre>
<!--web-only-->
<p>Previously the borrow checker wouldn't have been able to tell that <code>println!</code> would be able to safely print <code>x</code> because it was borrowed mutably by <code>y</code> so we would put the mutable borrow in its own scope. Thankfully non-lexical lifetimes save us from this rigamarole.</p>
<p>Next up is the ability to use the <code>dyn</code> and <code>impl</code> keyword to refer to data that conforms to a specific <code>trait</code> (rust's primary inheritance construct) in a far more convenient way. Previously it was not possible to use traits as return types unless they were first <code>Box</code>ed onto the heap, this lead to some extra run-time cost. </p>
<!--web-only-end-->
<!--slides-only-->
<h3><a class="header" href="#dynimpl-trait" id="dynimpl-trait">dyn/impl trait</a></h3>
<!--slides-only-end-->
<pre><pre class="playpen"><code class="language-rust">
fn main() {
    let boxed_fn = get_closure();
    let raw_fn = get_closure_better();
    println!(&quot;{}, {}&quot;, boxed_fn(10), raw_fn(7));
}

fn get_closure() -&gt; Box&lt;dyn Fn(usize) -&gt; usize&gt; {
    Box::new(|x| x * x)
}

fn get_closure_better() -&gt; impl Fn(usize) -&gt; usize {
    |x| x * x
}
</code></pre></pre>
<!--web-only-->
<p>While it might not seem like much, it is a pretty big performance win for this kind of code. Previously you would need to create a function pointer and allocate that function on the heap, this would lead to a v-table being crated and you could only call that function through the v-table now there is no heap allocation and also no v-table. Whoa... lots of jargon in that one, quickly and to the point it is a lot faster.</p>
<p>Now for the kicker, async/await has just started to stabilize, this is a huge win! Previously, to perform some asynchronous operation you would either need to spin up a thread manually and then create a channel to communicate across those threads which is cumbersome at best. </p>
<!--web-only-end-->
<!--slides-only-->
<h3><a class="header" href="#thread--channel" id="thread--channel">thread + channel</a></h3>
<!--slides-only-end-->
<pre><pre class="playpen"><code class="language-rust">use std::{
    thread::{
        spawn,
        sleep
    },
    sync::mpsc::{
        channel,
    },
    time::Duration,
};

fn main() {
    let (sender, receiver) = channel();
    let s1 = sender.clone();
    spawn(move || {
        let s = s1;
        for x in 0..10 {
            s.send(Some(x as isize)).unwrap();
            sleep(Duration::from_millis(50 * x));
        }
        s.send(None).unwrap();
    });
    let s2 = sender.clone();
    spawn(move || {
        sleep(Duration::from_millis(500));
        let s = s2;
        for y in (-10..0).rev() {
            s.send(Some(y)).unwrap();
            let sleep_inc = y.abs() as u64;
            sleep(Duration::from_millis(50 * sleep_inc));
        }
        s.send(None).unwrap();
    });
    let mut done = 0;
    while done &lt; 2 {
        match receiver.recv() {
            Ok(Some(m)) =&gt; println!(&quot;{}&quot;, m),
            Ok(None) =&gt; done += 1,
            _ =&gt; (),
        }
    }
}
</code></pre></pre>
<!--web-only-->
<p>The other option was to utilize this 3rd party library trait called <code>Future</code> the big problem here is that the type signature is so complicated that it is difficult to get everything right.</p>
<!--web-only-end-->
<!--slides-only-->
<h3><a class="header" href="#futures" id="futures">Futures</a></h3>
<!--slides-only-end-->
<pre><pre class="playpen"><code class="language-rust">use std::{
    time::Duration,
};

#[macro_use]
extern crate futures;
extern crate tokio;
use std::fmt;

use futures::{
    prelude::*,
    Stream,
};
use tokio::timer::Interval;
struct Counter {
    end: isize,
    idx: isize,
    inc: bool,
    interval: Interval,
}
impl Counter {
    fn new(min: isize, max: isize) -&gt; Self {
        Self {
            end: max,
            idx: min,
            inc: min &lt; max,
            interval: Interval::new_interval(Duration::from_millis(1)),
        }
    }
}
impl Stream for Counter {
    type Item = isize;
    type Error = ();
    fn poll(&amp;mut self) -&gt; Poll&lt;Option&lt;Self::Item&gt;, Self::Error&gt; {
        try_ready!(
            self.interval.poll()
                // The interval can fail if the Tokio runtime is unavailable.
                // In this example, the error is ignored.
                .map_err(|_| ())
        );
        let next_wait = self.idx.abs() as u64;
        self.interval = Interval::new_interval(
            Duration::from_millis(1 + next_wait * 10)
        );
        Ok(if self.inc {
            if self.idx &lt; self.end {
                self.idx += 1;
                Async::Ready(Some(self.idx))
            } else {
                Async::Ready(None)
            }
        } else {
            if self.idx &gt; self.end {
                self.idx -= 1;
                Async::Ready(Some(self.idx))
            } else {
                Async::Ready(None)
            }
        })
    }
}

pub struct DisplayCt&lt;T&gt; {
    stream: T,
}

impl&lt;T&gt; DisplayCt&lt;T&gt; {
    fn new(stream: T) -&gt; DisplayCt&lt;T&gt; {
        Self {
            stream,
        }
    }
}

impl&lt;T&gt; Future for DisplayCt&lt;T&gt;
where
    T: Stream,
    T::Item: fmt::Debug,
{
    type Item = ();
    type Error = T::Error;

    fn poll(&amp;mut self) -&gt; Poll&lt;(), Self::Error&gt; {
        
        loop {
            let value = match try_ready!(self.stream.poll()) {
                Some(value) =&gt; value,
                None =&gt; break,
            };

            println!(&quot;{:?}&quot;, value);
        }

        Ok(Async::Ready(()))
    }
}
fn main() {
    let ct1 = Counter::new(0, 10).map_err(|e| eprintln!(&quot;{:?}&quot;, e));
    let ct2 = Counter::new(0, -10).map_err(|e| eprintln!(&quot;{:?}&quot;, e));
    let d1 = DisplayCt::new(ct1);
    let d2 = DisplayCt::new(ct2);
    let joined = d1.join(d2);
    tokio::run(
        joined.and_then(|_| Ok(()))
    );
}
</code></pre></pre>
<!--web-only-->
<p>Just a short time ago, the <code>Future</code> trait was co-opted by the rust standard library, so that it could be coupled with the keywords async and await. Similar to how JavaScript co-opted the concept of Promises to work with its async/await syntax, rust will be able to abstract all the Future craziness into these keywords.</p>
<p>It is anticipated to look something like this.</p>
<!--web-only-end-->
<!--slides-only-->
<h3><a class="header" href="#asyncawait" id="asyncawait">async/await</a></h3>
<!--slides-only-end-->
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let up = || {
    for i in 0..10 {
        println!(&quot;{}&quot;, i);
        yield;
    }
    return;
};
let down = || {
    for i in (-10..0).rev() {
        println!(&quot;{}&quot;, i);
        yield;
    }
    return;
};
let up_gen = from_generator(up);
let down_gen = from_generator(down);
up_gen.await;
down_gen.await;
#}</code></pre></pre>
<!--web-only-->
<p>Sadly, that last example wont run right now but the last major RFC for a true MVP was just slated for stabilization. Since rust runs on a 6 week release cycle, that means we are looking at fewer than 12 weeks before this is fully realized.</p>
<p>Rust has been going through a huge ergonomic push to make life easier, things like non-lexical lifetimes have already made the learning curve ease up a bit. With async/await even much more advanced programs won't cause a developers head to explode.</p>
<p>With that, let's take a quick glance at a few other features rust can boast about.</p>
<!--web-only-end-->
<script>var PresentationMode;!function(e){e[e.Slides=0]="Slides",e[e.Web=1]="Web"}(PresentationMode||(PresentationMode={}));var PresentationModeHider=function(){function e(){var t=this;(this.queryKey="presentation_mode",this.webClass="article-content",this.preClass="presentation-only",this.mode=this.getMode(),this.setMode(),this.assignClassesViaComments(),this.mode!==PresentationMode.Slides||""!==location.pathname&&"/"!==location.pathname)||document.querySelector(".sidebar > .chapter").firstChild.firstChild.click();window.addEventListener("keyup",function(e){e.altKey&&("p"!=e.key&&"P"!=e.key&&"KeyP"!=e.code||t.toggle())})}return e.prototype.assignClassesViaComments=function(){for(var e,t=document.createNodeIterator(document.body,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null),n=this.mode===PresentationMode.Web?"not-presenting":"presenting",o=null;e=t.nextNode();)if(8===e.nodeType){var s=e.nodeValue.trim();o="web-only"===s?this.webClass:"slides-only"===s?this.preClass:null}else 1===e.nodeType&&null!==o&&e.classList.add(o,n)},e.prototype.getMode=function(){var t=localStorage.getItem(this.queryKey);if(null===t)return PresentationMode.Web;try{var e=parseInt(t);return 1<e||e<0?(console.error("presentation_mode was out of range",e),PresentationMode.Web):e}catch(e){return console.error("presentation_mode present in localStorage but value is not an integer",t,e),PresentationMode.Web}},e.prototype.setMode=function(){localStorage.setItem(this.queryKey,this.mode.toString())},e.prototype.updatePage=function(){this.updateElements(document.querySelectorAll(".presentation-only")),this.updateElements(document.querySelectorAll(".article-content"))},e.prototype.updateElements=function(e){for(var t=0;t<e.length;t++){var n=e[t];this.mode===PresentationMode.Slides?n.classList.replace("not-presenting","presenting"):n.classList.replace("presenting","not-presenting")}},e.prototype.toggle=function(){switch(this.mode){case PresentationMode.Slides:this.mode=PresentationMode.Web;break;case PresentationMode.Web:this.mode=PresentationMode.Slides}this.setMode(),this.updatePage()},e}(),___presentationModeHider=new PresentationModeHider;</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="chapter_2.5.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="chapter_4.0.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="chapter_2.5.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="chapter_4.0.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="counter.js"></script>
        

        

    </body>
</html>
